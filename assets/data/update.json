{
  "branch": "main",
  "ops": [
    {
      "op": "write",
      "path": ".github/workflows/build-file-inventory.yml",
      "content": "name: Build File Inventory\n\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch: {}\n\njobs:\n  build-inventory:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Node\n        uses: actions/setup-node@v4\n        with:\n          node-version: 20\n\n      - name: Build inventory\n        run: node scripts/gen-file-inventory.mjs\n        env:\n          INVENTORY_OUT_JSON: dev/data/file-tree.json\n          INVENTORY_OUT_TXT: dev/data/file-tree.txt\n          INVENTORY_METRICS: dev/data/repo-metrics.json\n          INVENTORY_IGNORE: >-\n            .git/**,node_modules/**,.github/**,\n            archive/**,dev/**/archive/**,\n            assets/videos/**,assets/gc_spin.mp4\n\n      - name: Upload artifacts (inventory)\n        if: always()\n        uses: actions/upload-artifact@v4\n        with:\n          name: repo-inventory\n          path: |\n            dev/data/file-tree.json\n            dev/data/file-tree.txt\n            dev/data/repo-metrics.json\n"
    }
  ]
}
