{
  "ops": [
    {
      "op": "write",
      "path": ".github/workflows/repo-snapshot.yml",
      "content": "name: Repo Snapshot\n\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch:\n\npermissions:\n  contents: write\n\njobs:\n  snapshot:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Node\n        uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n\n      - name: Generate repo snapshot\n        run: node scripts/repo-snapshot.mjs\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: Commit & push snapshot (if changed)\n        run: |\n          git config user.name \"github-actions[bot]\"\n          git config user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n          git add dev/**/archive/*.json dev/archive/*.json\n          if ! git diff --cached --quiet; then\n            git commit -m \"Repo Snapshot: $(date -u +'%Y-%m-%dT%H:%M:%SZ')\"\n            git push\n          else\n            echo \"No changes to commit.\"\n          fi\n"
    },
    {
      "op": "write",
      "path": ".github/workflows/build-file-inventory.yml",
      "content": "name: Build File Inventory\n\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch:\n\npermissions:\n  contents: write\n\njobs:\n  inventory:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Node\n        uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n\n      - name: Generate file inventory\n        run: node scripts/gen-file-inventory.mjs\n        env:\n          INVENTORY_OUT_JSON: dev/data/file-tree.json\n          INVENTORY_OUT_TXT: dev/data/file-tree.txt\n          INVENTORY_METRICS: dev/data/repo-metrics.json\n\n      - name: Commit & push inventory (if changed)\n        run: |\n          git config user.name \"github-actions[bot]\"\n          git config user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n          git add dev/data/file-tree.json dev/data/file-tree.txt dev/data/repo-metrics.json\n          if ! git diff --cached --quiet; then\n            git commit -m \"Build File Inventory: $(date -u +'%Y-%m-%dT%H:%M:%SZ')\"\n            git push\n          else\n            echo \"No changes to commit.\"\n          fi\n"
    },
    {
      "op": "write",
      "path": ".github/workflows/repo-hygiene.yml",
      "content": "name: Repo Hygiene\n\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch:\n\npermissions:\n  contents: read\n\njobs:\n  json:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n      - name: Check JSON\n        run: node scripts/check-json.mjs\n\n  svg:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n      - name: SVG sanity\n        run: node scripts/svg-sanity.mjs\n\n  verify_inventory:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n      - name: Verify inventory files\n        run: node scripts/verify-inventory.mjs\n"
    },
    {
      "op": "write",
      "path": ".github/workflows/link-check.yml",
      "content": "name: Link Check\n\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch:\n\npermissions:\n  contents: read\n\njobs:\n  lychee:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - name: Run lychee\n        uses: lycheeverse/lychee-action@v1\n        with:\n          args: >-\n            --no-progress --require-https --max-redirects 5\n            --exclude-mail --accept 200,206,429\n            --exclude-path archive/** dev/** node_modules/**\n            .\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n"
    },
    {
      "op": "write",
      "path": ".github/workflows/assets-manifest.yml",
      "content": "name: Assets Manifest\n\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch:\n\npermissions:\n  contents: write\n\njobs:\n  manifest:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n      - name: Build/Update asset manifests\n        run: node scripts/bump-asset-manifest.mjs\n      - name: Commit & push (if changed)\n        run: |\n          git config user.name \"github-actions[bot]\"\n          git config user.email \"41898282+github-actions[bot]@users.noreply.github.com\"\n          git add assets/manifest.json assets/videos/manifest.json\n          if ! git diff --cached --quiet; then\n            git commit -m \"Assets Manifest: $(date -u +'%Y-%m-%dT%H:%M:%SZ')\"\n            git push\n          else\n            echo \"No changes to commit.\"\n          fi\n"
    }
  ]
}
