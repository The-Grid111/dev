{
  "op": "multi-write",
  "changes": [
    {
      "path": ".github/workflows/build-inventory.yml",
      "content": "name: build-inventory\n\non:\n  push:\n    branches: [ main ]\n    paths: [ 'assets/data/update.json' ]\n\npermissions:\n  contents: write\n\njobs:\n  inventory:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n          persist-credentials: true\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: 20\n\n      - name: Generate inventory stubs\n        run: |\n          mkdir -p dev/dev/data\n          echo '{\"files\":[]}' > dev/dev/data/file-tree.json\n          echo '# Empty inventory' > dev/dev/data/file-tree.txt\n          echo '{\"metrics\":{}}' > dev/dev/data/repo-metrics.json\n\n      - name: Stage changes & summarize\n        id: stage\n        shell: bash\n        run: |\n          git add dev/dev/data/file-tree.json dev/dev/data/file-tree.txt dev/dev/data/repo-metrics.json\n          if git diff --cached --quiet; then\n            echo \"NO_CHANGES=true\" >> $GITHUB_ENV\n            echo \"### Build File Inventory\\n\\nNo changes to commit.\" >> \"$GITHUB_STEP_SUMMARY\"\n          else\n            COUNT=$(git diff --name-only --cached | wc -l | tr -d ' ')\n            echo \"FILES_CHANGED=$COUNT\" >> $GITHUB_ENV\n            echo \"### Build File Inventory\\n\\n**Files staged:** $COUNT\" >> \"$GITHUB_STEP_SUMMARY\"\n          fi\n\n      - name: Auto-commit inventory\n        if: env.NO_CHANGES != 'true'\n        uses: stefanzweifel/git-auto-commit-action@v5\n        with:\n          commit_message: \"[auto] update build-file-inventory\"\n          file_pattern: dev/dev/data/file-tree.json dev/dev/data/file-tree.txt dev/dev/data/repo-metrics.json\n          commit_options: '--no-verify --signoff'\n          push_options: '--force'\n"
    },
    {
      "path": ".github/workflows/repo-snapshot.yml",
      "content": "name: repo-snapshot\n\non:\n  push:\n    branches: [ main ]\n    paths: [ 'assets/data/update.json' ]\n\npermissions:\n  contents: write\n\njobs:\n  snapshot:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n          persist-credentials: true\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: 20\n\n      - name: Create repo snapshot\n        run: |\n          mkdir -p dev/dev/archive\n          NOW=$(date +%s)\n          FILE=\"dev/dev/archive/snapshot_${NOW}.json\"\n          echo '{\"snapshot\":\"data\"}' > \"$FILE\"\n          echo \"### Repo Snapshot\\n\\n**Created:** $FILE\" >> \"$GITHUB_STEP_SUMMARY\"\n\n      - name: Stage changes & summarize\n        id: stage\n        shell: bash\n        run: |\n          git add dev/dev/archive/snapshot_*.json\n          if git diff --cached --quiet; then\n            echo \"NO_CHANGES=true\" >> $GITHUB_ENV\n            echo \"(No new snapshot to commit)\" >> \"$GITHUB_STEP_SUMMARY\"\n          else\n            COUNT=$(git diff --name-only --cached | wc -l | tr -d ' ')\n            echo \"FILES_CHANGED=$COUNT\" >> $GITHUB_ENV\n            echo \"**Files staged:** $COUNT\" >> \"$GITHUB_STEP_SUMMARY\"\n          fi\n\n      - name: Auto-commit snapshot\n        if: env.NO_CHANGES != 'true'\n        uses: stefanzweifel/git-auto-commit-action@v5\n        with:\n          commit_message: \"[auto] repo snapshot\"\n          file_pattern: dev/dev/archive/snapshot_*.json\n          commit_options: '--no-verify --signoff'\n          push_options: '--force'\n"
    }
  ]
}
